<!DOCTYPE html>
<html lang="en">
  <head>
    <link rel="stylesheet" href="../styles/index_styles.css" />
    <link rel="stylesheet" href="../../assets/stylesheets/inter-font.css" />
    <script src="./index.js"></script>
    <script src="../../assets/js/tailwind.min.js"></script>
    <script>
      window.FontAwesomeConfig = { autoReplaceSvg: "nest" };
    </script>
    <script src="../../assets/js/font-awesome.min.js"></script>
    <style>
      /* Kraken widget removal animations */
      .removing {
        user-select: none;
        cursor: not-allowed;
        background: linear-gradient(45deg, transparent 25%, rgba(255,0,0,0.05) 25%, rgba(255,0,0,0.05) 50%, transparent 50%, transparent 75%, rgba(255,0,0,0.05) 75%);
        background-size: 20px 20px;
        animation: removing-stripes 1s linear infinite;
      }
      
      @keyframes removing-stripes {
        0% { background-position: 0 0; }
        100% { background-position: 20px 0; }
      }
      
      .removing * {
        pointer-events: none !important;
      }
    </style>
    <meta
      http-equiv="X-Content-Security-Policy"
      content="default-src 'self'; script-src 'self'"
    />
    <title>Kraken Calibration</title>
  </head>

  <body class="h-full text-base-content">
    <!-- Main loader for page -->
    <div
      id="page-loader"
      class="fixed inset-0 flex items-center justify-center bg-white bg-opacity-75 z-50 hidden"
    >
      <div class="text-center">
        <div
          class="animate-spin rounded-full h-16 w-16 border-4 border-neutral-300 border-t-neutral-800 mx-auto mb-4"
        ></div>
        <p class="text-lg">Initializing calibration...</p>
      </div>
    </div>

    <div id="app-container" class="min-h-screen bg-neutral-50">
      <header class="bg-white border-b border-neutral-200 fixed w-full z-40">
        <div
          class="container mx-auto px-4 py-3 flex items-center justify-between"
        >
          <div class="flex items-center space-x-4">
            <h1 class="text-xl font-semibold">Kraken Calibration</h1>
            <span id="connection-status" class="text-sm text-neutral-600"></span>
          </div>
        </div>
      </header>

      <main id="main-content" class="pt-16 container mx-auto px-4">
        <!-- Back Button -->
        <div id="back-button-calibration" class="mt-5">
          <button
            class="flex items-center px-4 py-2 border border-neutral-300 bg-white text-neutral-700 rounded-md hover:bg-neutral-100 transition-colors duration-200"
          >
            <i class="fa-solid fa-arrow-left mr-2"></i> Back to Sensor List
          </button>
        </div>

        <div class="py-6">
          <!-- Connected Devices Section -->
          <div id="connected-devices-section">
            <div class="mb-6">
              <h2 class="text-xl font-semibold mb-2">Connected Krakens</h2>
              <p class="text-neutral-600">
                Setting up services and characteristics for each connected sensor
              </p>
            </div>

            <!-- Devices Grid -->
            <div
              id="devices-grid"
              class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"
            >
              <!-- Device widgets will be inserted here dynamically -->
          </div>

            <div class="flex items-center justify-between">
              <h2 class="text-xl">Calibration Control</h2>
              <div class="flex gap-3">
                <button
                  id="start-calibration-btn"
                  disabled
                  class="px-6 py-2 bg-neutral-800 text-white rounded-lg disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 hover:bg-neutral-700"
                >
                  <i class="fa-solid fa-play mr-2"></i> Start Calibration
                </button>
              </div>
            </div>
          </div>
        </div>
      </main>
    </div>

    <!-- Error Alert Modal -->
    <div
      id="error-alert"
      class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden"
    >
      <div class="bg-white rounded-lg p-6 max-w-md w-full text-center">
        <div class="mb-4">
          <i class="fa-solid fa-exclamation-triangle text-red-500 text-4xl mb-3"></i>
          <h3 class="text-lg font-semibold">Setup Error</h3>
        </div>
        <p id="error-message" class="mb-4 text-neutral-700"></p>
        <button
          id="error-ok-btn"
          class="px-6 py-2 bg-neutral-800 text-white rounded-lg hover:bg-neutral-700"
        >
          OK
        </button>
      </div>
    </div>
  </body>
</html> 